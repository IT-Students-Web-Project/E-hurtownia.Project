
@{
    ViewData["Title"] = "Change password";
}

<h1>Change password to your account</h1>
<h5>Enter current password and then repeat new password two times to confirm changes</h5>

<div class="container col-12 my-5">
    <div class="row">
        <div class="col-4">
            <form method="post">
                <div class="form-group">
                    <label>Old password</label>
                    <input type="password" class="form-control" name="password-old" />

                    @if (ViewBag.CurrentPasswordIncorrect != null) {
                        <small class="text-danger">Incorrect old password</small>
                    } else {
                        <small>Enter your current password</small>
                    }
                </div>

                <div class="form-group">
                    <label>New password</label>
                    <input type="password" class="form-control" name="password-new" />

                    @if (ViewBag.NewPasswordInvalid != null) {
                        <small class="text-danger">Invalid new password, too long or too short</small>
                    } else {
                        <small>Enter new password (between 5 and 30 characters)</small>
                    }
                </div>

                <div class="form-group">
                    <label>Repeat password</label>
                    <input type="password" class="form-control" name="password-new-repeat" />

                    @if (ViewBag.RepeatPasswordDoNotMatch != null) {
                        <small class="text-danger">Passwords do not match</small>
                    } else {
                        <small>Repeat new password</small>
                    }
                </div>

                <input type="submit" class="btn btn-primary mr-3" value="Confirm" asp-controller="User" asp-action="ChangePasswordConfirm" />
                <input type="submit" class="btn btn-secondary" value="Cancel" asp-controller="User" asp-action="Index" />
            </form>
        </div>
    </div>
</div>

@section CheckUserLogged {
    @if (ViewBag.COOKIE_LOGGED_USERNAME == null) {
        <form method="post" class="form-inline">
            <input type="submit" class="btn btn-primary btn-outline-primary" value="Sign in / Sign up" asp-controller="User" asp-action="Login" />
        </form>
    } else {
        <form method="post" class="form-inline">
            <label class="text-light">Logged in as&nbsp;<label class="text-info border-right">@ViewBag.COOKIE_LOGGED_USERNAME&nbsp;</label></label>&nbsp;
            <a class="text-danger" asp-controller="User" asp-action="Logout">Log out</a>
        </form>
    }
}